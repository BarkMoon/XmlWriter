# XmlWriter CLI (Command Line Interface) 機能

`XmlWriter.exe` はGUIでの操作に加え、コマンドライン引数を指定することで、自動処理（バッチ実行）が可能になりました。
CI/CDパイプラインやバッチスクリプトからのデータ生成に使用できます。

## 使用方法

コマンドラインから以下の形式で実行してください。3つの引数がすべて必須です。

```powershell
XmlWriter.exe <ExcelFilePath> <OutputDir> <TemplateFilePath>
```

### 引数説明

1.  **ExcelFilePath** (`string`)
    *   読み込むExcelファイル（`.xlsx`）へのフルパス。
2.  **OutputDir** (`string`)
    *   生成物を出力するルートディレクトリのパス。
    *   このフォルダ内に `xml` および `code` フォルダが自動生成されます。
3.  **TemplateFilePath** (`string`)
    *   C#クラス生成用に使用するテンプレートファイル（`.cs`）へのフルパス。
    *   **注意**: 指定したテンプレートファイルを使用して、Excelファイル内の**すべてのテーブル**に対するクラスコードが生成されます。

### 実行例

```powershell
XmlWriter.exe "D:\Data\GameData.xlsx" "D:\Data\Out" "D:\Tools\XmlWriter\Templates\Template_Card.cs"
```

---

## 出力仕様

指定された `OutputDir` の下に、以下の構造でファイルが出力されます。

```text
OutputDir/
├── xml/
│   └── [テーブル名]/
│       ├── [テーブル名]_[ID].xml
│       └── ...
└── code/
    └── [テーブル名].cs
```

## 注意事項

旧バージョンとは異なり、テンプレートの自動選択機能はありません。
コマンドラインで指定した1つのテンプレートファイルが、Excelに含まれるすべてのテーブルに対して適用されます。
もしテーブルごとに異なるテンプレート（例: カード用とカードコレクション用）を適用したい場合は、Excelファイルを分けるか、ツールを複数回実行するなどの対応が必要です。

## エラーハンドリング

*   引数が不足している場合、使用方法をコンソールに出力して終了します。
*   指定されたExcelファイルやテンプレートファイルが存在しない場合など、例外が発生した際はエラーメッセージとスタックトレースをコンソールに出力します。
