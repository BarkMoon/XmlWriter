Excelロード拡張で、
Functions.CardEffects:(EXテーブル名＝クラス名)[] = {1 (EXテーブル内のID), 2, }



Cost.OriginalCost:string = "1G", "2GG", "3", "0":
カードをプレイするための、元々のコスト。
マナ色など、単なる数値でない場合があるため、数値でもstring扱いでPropertiesで保存。
共通処理にマナ前提の処理は入れないと思うが、あっても0コストにすればよいので困りはしないかも。

cardCost.PlayCost:string = "3G", "4GG", "5", "2":
カードの効果などで色々付与した後のカードプレイコスト。
墓地から唱える時に違うコストでプレイ可能になる場合なども、ここの数値が変わる。
何も無ければOriginalCostと同じ。

class/struct CardFunctionParameter = {This:CardClass, SubjectPlayer:PlayerClass, Target:ITargetObject(PlayerClass, CardClass, ZoneClass, ...), CastMode:CastModeEnum}:
カード効果実行用のパラメータクラス。
カードのOwnerと、効果を起動したSubjectPlayerは一致するとは限らない。
CastMode=CastModeEnum.CheckOnlyであれば、効果を実際に実行はせずに返す。(「PayAllCostsで払えるかどうか」のみ見たい場合などに使う。)

Cost.PayAdditionalCost:Func<CardFunctionParameter, bool>:
PlayCost以外のコスト(「クリーチャーを1体生贄に捧げる」「他のクリーチャーを1体タップする」などの複雑な効果)を払う。
CastMode=CastModeEnum.CheckOnlyであれば、追加コストを払えるかのみチェック。払えればtrue。
CastMode=CastModeEnum.Doであれば、コストを実際に払う。成功すればtrue。
不要であればCardCollection.FuncNoneを指定する。

Functions.PayAllCosts = Func<CardFunctionParameter, bool>:
cardCost.PlayCostを払い (共通処理) 、Cost.AdditionalCost(parameter)を払う。
CastMode=CastModeEnum.CheckOnlyであれば、全コストを払えるかのみチェック。払えればtrue。
CastMode=CastModeEnum.Doであれば、コストを実際に払う。成功すればtrue。

EffectGenreEnum { Activate, Auto, Permanent }:
能力の種別。
Activateは起動効果、Autoは自動誘発効果、Permanentは永続効果。

class CardEffectClass = {EffectGenreEnum, CommonCost:string, PayAdditionalCost:Func<CardFunctionParameter, bool>, Function:Func<CardFunctionParameter, bool>}:
CommonCostはPlayCostと同じ形式で、カード効果は"T"(このカードをタップする), "S"(このカードを墓地に送る)などはこちらに含めてもいいかも。
PayAdditionalCostは同じ。
Functionは効果。
メソッドとしてPayAllCosts()を持つ。


例：
並外れた語り部のアンタップ効果⇒{EffectGenreEnum.Activate, "1T", CardCollection.FuncNone, CardCollection.UntapOnePermanent}
????食糧庫の備蓄の物資カウンターを置く効果⇒{EffectGenreEnum.Auto, "0", CardCollection.FuncNone, CardCollection.UntapOnePermanent}
→自動効果はイベントをトリガーにするので、それは指定したい……。

cardFunctions.CardEffects:CardEffectClass[] = {CardEffectClass0, CardEffectClass1, ...}:
カード効果のリスト。
